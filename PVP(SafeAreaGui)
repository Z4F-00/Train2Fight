local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local PlayerGui = LocalPlayer:WaitForChild("PlayerGui")

-- Get Area
local Area = {
	workspace:WaitForChild("Area"):WaitForChild("PlayerArea"):WaitForChild("S2")
}

-- InvokePVP
local Remote = game:GetService("ReplicatedStorage"):WaitForChild("Area"):WaitForChild("Remote")
local PlayerAreaOut = Remote:WaitForChild("PlayerAreaOut")
local PlayerAreaIn = Remote:WaitForChild("PlayerAreaIn")

function invokePVP(PVPType)
	if PVPType then
		PlayerAreaOut:InvokeServer(unpack(Area))
	else
		PlayerAreaIn:InvokeServer(unpack(Area))
	end
end

-- Safe Area Gui On 
local pvpAreaGui = PlayerGui:WaitForChild("SafeAreaGui"):WaitForChild("ContentFrame")
local pvpAreaGuiOn = pvpAreaGui:WaitForChild("On")
local pvpAreaGuiOff = pvpAreaGui:WaitForChild("Off")

-- Variabel untuk elemen UI
local function createInSafeAreaGui(parentName)
    -- Bg
    local pvpAreaBg = parentName:WaitForChild("Bg")
    
	-- Membuat TextButton sebagai area yang bisa diklik
	local clickButton = Instance.new("TextButton")
	clickButton.Name = "ButtonArea"
	clickButton.AnchorPoint = Vector2.new(0.5, 0.5)
	clickButton.Size = UDim2.new(pvpAreaBg.Size.X.Scale, pvpAreaBg.Size.X.Offset, pvpAreaBg.Size.Y.Scale * 2, pvpAreaBg.Size.Y.Offset) -- Sebesar Bg SafeAreaGui
	clickButton.Position = pvpAreaBg.Position -- Posisi yang sama dengan Bg
	clickButton.BackgroundTransparency = 1 -- Transparansi
	clickButton.Text = "" -- Tidak ada teks
	clickButton.Parent = parentName

	-- Menghubungkan fungsi ke event klik tombol
	clickButton.MouseButton1Click:Connect(function()
		local currentStatus = pvpAreaGuiOn.Visible
		invokePVP(not currentStatus)
	end)
end

local getButtonPVPAreaGui = pvpAreaGui:FindFirstChild("ButtonArea")
local getButtonPVPAreaGuiOn = pvpAreaGuiOn:FindFirstChild("ButtonArea")
local getButtonPVPAreaGuiOff = pvpAreaGuiOff:FindFirstChild("ButtonArea")

if not getButtonPVPAreaGuiOn then
	createInSafeAreaGui(pvpAreaGuiOn)
end

if not getButtonPVPAreaGuiOff then
	createInSafeAreaGui(pvpAreaGuiOff)
end
